\documentclass[11pt,letterpaper]{article}
\usepackage[pdftex,draft=false,debug=false]{hyperref}
\usepackage{graphicx}
\usepackage{verbatim}
\usepackage{amssymb}
\usepackage{booktabs}
\usepackage[a4paper]{geometry}
\usepackage{color}
\usepackage{hyperref}
\usepackage{multicol}

%\usepackage[ansinew]{inputenc}
%\usepackage{cite}
%\usepackage{eurosym}
%%%%%
%\usepackage{epsfig}
%\usepackage{multicol,graphics,verbatim}
%\usepackage{longtable}
%\usepackage{colortbl}
%\usepackage{lineno}

%\linenumbers%           comment out to switch off line numbers

%\linespread{1.3}
\usepackage[font=footnotesize,format=plain,labelfont=bf,up,textfont=up]{caption}
%\setcaptionmargin{0.05\textwidth}
\interfootnotelinepenalty=10000
\usepackage{multirow}
\hyphenpenalty=5000
%\usepackage{scrtime}                           % time access
%\usepackage[draft]{prelim2e}
%\renewcommand{\PrelimText}{\footnotesize{Draft Version (\today\ - \thistime)}}


\usepackage{microtype}
%\hyphenpenalty=5000
\interfootnotelinepenalty=10000
\usepackage{float}
\setcounter{topnumber}{4}
\setcounter{bottomnumber}{4}
\setcounter{totalnumber}{12}
\renewcommand{\topfraction}{0.8}
\renewcommand{\bottomfraction}{0.6}



% --------------------------------------------------------  define the report
\newcommand{\repnumber}  {LN-21-001}
\newcommand{\repdate}    {August 23, 2021}
\newcommand{\titleheader}{%
Chat-application proposal for LEGEND 200 ~\\
}
% -----------------------------------------------------------------------------

% defs
\newcommand{\ctsper}{\ensuremath{\text{cts}/(\text{keV}\cdot\text{kg}\cdot\text{yr})}}
\newcommand{\us}{{\,$\mu$s}}
\newcommand{\ns}{{\,ns}}
\newcommand{\Qbb}{{\ensuremath{\text{Q}_{\beta\beta}}}}
\newcommand{\Qbbwindow}{\mbox{\Qbb(160\,keV)}}


%\usepackage[T1]{fontenc}
%\usepackage{times}

\usepackage{amsmath}


\usepackage{array}
\usepackage[parfill]{parskip}

%
% -----------------------------------------------------------------------------
% --------------------------------------------------------  begin document

\begin{document}
% --------------------------------------------------------  begin titlepage
\begin{titlepage}
% -----------------------------------------------------------------------------
\vspace*{-7truecm}

\parbox[b]{40mm}{
%  \includegraphics[scale=0.25]{./gerda-GSTR-logo.pdf}
  }
\parbox[b]{110mm}{\hfill\hfill
{\sc LEGEND} Note:~~ {\bf\repnumber}\\[12mm]
 \hspace*{30mm}\hfill\hfill\repdate}

\vspace*{20mm}
\begin{center}
{\Large\bf \titleheader}

\vspace*{10mm}
LEGEND Communications Team \\


\vspace*{10mm}
%$^a$)~University of Washington\\[1mm]
\vspace*{20mm}
\begin{abstract}%
\noindent 
This note describes a proposal for the LEGEND Collaboration to switch from the RocketChat team-chat application to Slack.
\end{abstract}

\end{center}
\vfill
\end{titlepage}
\vfill
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
% settings
\pagenumbering{arabic}
\setcounter{page}{1}
\pagestyle{myheadings}
\markboth{~-~~\repnumber\hfill\titleheader}{\titleheader\hfill\repnumber~~-~}
\newpage
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
% main text
%\tableofcontents


\section{Background}
Chat applications (apps) are paramount to a large international collaboration, enabling discussion across multiple timezones and a fast exchange of ideas. Chat applications can keep mundane, functional conversations out of a collaborator's already full inbox. For example querying a meeting time, asking for a pointer to slides shown in a talk, asking to borrow a pen are all discussions that, for a local working group, would stay out of email and be discussed in person. In lieu of physical proximity, chat apps help facilitate communicating some of the mundanities associated with organization and planning. They also allow for a more natural flow of discussion when exchanging ideas. \\
Whilst chat applications should not be used to store, or as the sole source of, information: their structure allows international collaborators to communicate more informally and build a sense of community. Chat apps can also help accelerate workflows, especially for software development. Chat apps such as Slack have support to integrate hundreds of tools including Jira and Github. \\
Chat apps have a common structure. A 'workspace' is set up around a theme, in this case the LEGEND collaboration. Each workspace then has text-based channels created, for example currently the collaboration has channels for the DAQ, conferences, and data analysis routines amongst other topics. The workspace also allows individuals to directly message each other. The workspace is moderated by a handful of administrators to help create channels and add users. \\

Since 2018, the LEGEND collaboration has been using Rocket Chat: an open-source, privately hosted chat app to discuss topics from the Post-GERDA Test to meeting agendas. RocketChat has enabled the 350+ members of the LEGEND workspace to send over $70,000$ messages, most of which were sent in the last 2 years. 
However recent events and cumulative experience have led to the decision to reevaluate whether RocketChat is still the application that best fits the needs of the collaboration. 

\section{RocketChat issues}
Push-notifications are messages sent by the chat service to users to indicate that something, typically a thread or channel they're following, has new information. In mobile or computer-based apps, push notifications can appear as pop-up, whilst many users instead opt for email-based push-notifications only. For example, if someone replies to a thread a collaborator has posed a question on and tags their username, that person will receive either an email or a pop-up that they have been mentioned. This functionality is important in chat apps since discussion, by the nature of the app, often moves quickly and people are tagged when their input is needed.\\
 In December of 2020, Rocket Chat changed their push-notification policy for members using their gateway to be limited to 5000 notifications per month per team for all free plans. To put that in perspective, the LEGEND rocket chat server has 356 members: so each could at most receive 14 notifications a month before this limit was hit. If a user follows multiple active channels the 14 notifications limit would be reached relatively quickly. To bypass this constraint the collaboration would have to opt for a paid plan, for which several options exist. 
Arguably, the main benefit of using RocketChat up to this point has been that it offers much the same functionality of other chat apps but for free. With a paid-option now being necessary, it is worth examining other issues with RocketChat to see if these might be alleviating with another option:
\begin{itemize}
\item \textbf{Person-power overhead}: RocketChat does still offer users the ability to have a free push-notification gateway, but one that is hosted by the user instead. The drawback is that the gateway would have to be hosted and maintained by the LEGEND communications team, and in addition, the team would have to build and publish custom Rocket Chat mobile applications for both iOS and Google Android platforms (with an associated licensing fee for both the iOS and Play stores): and users would have to download these from the app store to receive the notifications. The overhead of maintaining applications and an additional gateway for the communication would place a large burden on the communications team. The communications team would like to minimise the burden of IT-based tasks on collaboration members. 
\item \textbf{Multiple failure points:} An AWS hosts the LDAP service used for authentication across all LEGEND platforms including RocketChat, AWS is also used for the RocketChat server, and the AWS connection to the outside must be maintained. If any one of these services is interrupted, members will lose access to RocketChat. This is without the additional issues associated with managing custom notification apps for two mobile platforms, if LEGEND were to use a custom push-notification gateway. Early in 2020 some of these issues, for example the AWS external connection being interrupted, resulted in the collaboration losing access to RocketChat intermittently.  Switching to a service with less failure points, and crucially less failure points that rely on members of the collaboration monitoring and maintaining them, is prudent. 
\item \textbf{Inconsistent notifications}: RocketChat allows users to select what sort of notifications they would like to receive. For example a user may select that they are notified when others post in specific channel, or only if they are tagged explicitly. However, collaborators have reported that notifications are inconsistent, despite these settings. It is important that users can rely on notifications being handled according to their personal settings so they do not miss messages they would have otherwise wanted to receive or are bombarded with messages they don't care about.
\item \textbf{Attachment handling}: RocketChat allows users to upload documents and images but does not allow users to preview common document-types, for example PDFs, without downloading them first. RocketChat does also not support searching the contents of attachments. 
\item \textbf{Threading:} RocketChat introduced threading to the application in 2019, but compared to similar applications following a thread can be difficult in RocketChat. If a thread on a channel is commented on users have to access the channel and scroll to find the thread before ebing able to read the update. In comparison, applications such as Slack and Mattermost have a separate thread-notification to read the new messages in one-click without having to search for them.  
\end{itemize}

\section{Alternatives and recommendation}
When looking for alternatives the following criteria were considered, in addition to resolving the existing issues with RocketChat:

\begin{enumerate}
\item LDAP authentication with Single Sign-On (SSO) should be supported. 
\item A cloud-hosted server that does not need to be maintained by LEGEND.
\item Notifications should be customizable.
\item History, search, attachments, and threading should all be supported. 
\end{enumerate}
With that criteria in mind the following alternatives were considered:

\begin{itemize}
\item \emph{Mattermost} is a free, privately hosted open source chat app which is very similar to RocketChat but with a similar UI to Slack. It has some advantages, for example no limits on the number of users per server, history is retained, and push notifications are easily customizable whilst still on the free version. However, like RocketChat the free version still requires that the server be hosted and maintained privately. The main downside to using Mattermost on LEGEND is that incorporating LDAP for authentication requires using a paid version. 
\item \emph{Discord} is a free chat app originally developed for recreational gaming and so readily supports video and audio channels as well as text-based. The app is cloud-hosted and has no limits on users, history, or push notifications. However, since this app was designed for more casual use it does lack some functionality: LDAP integration is not supported, threading is not supported, DM's are placed outside the server which limits the controls administrators can place on them, and file uploads are limited to 8 MB.
\item \emph{Microsoft teams} is an enterprise chat application in which users are assigned roles that allow them to interact in.various team-chats. The main advantage of Microsoft Teams is its integration with other Microsoft products and its ability to support a large number of users. However the way in which channels are constructed is very limited when compared with RocketChat and would constrain the way users can communicate. For example, threading in channels is mandatory which makes browsing discussions difficult. In addition, the overhead in setting up a new server for Teams is substantial. Given that the collaboration does not use other products in the Microsoft Business suite, there is no real advantage to using Teams. 
\item \emph{Google chat} is an enterprise chat application which is almost identical to Microsoft Teams in organization except that it has excellent integration with the Google suite of products rather than the Microsoft suite. As with Teams, since the LEGEND collaboration is not already paying for a Google Workspace, there is no advantage in paying for gChat. 
\item \emph{Slack} is one of the most popular team chat apps with 10 million daily users and is also the oldest chat app on this list. The free options on this list, including Mattermost and RocketChat, were arguably formed in direct response to the popularity of Slack: supplying users with the option of a free, open-source version of the software whilst maintaining the same UI principles. Slack has both paid and free options. The downside of the free options is that they limit the number of users to a workspace, put a cap on message history, and do not support LDAP authentication. 
\end{itemize}

\subsection{Recommendation to use Slack}
The communications team would like to recommend that the LEGEND collaboration use Slack in place of RocketChat going forward. The main reasons for this are that, aside from meeting the criteria listed at the top of this section and alleviating all of the issues seen with RocketChat, Slack is both too extensively used to experience any significant technical issues/downtime and has many pre-existing users in LEGEND. Slack also has an in-built caching for SSO. This means that if the LEGEND LDAP server experiences any down-time, Slack users who were already signed into the workspace will be able to continue using it and not be booted from the service.\\
In January 2021, a survey was conducted of the Early Career members and found that 96\% of them would like to move from RocketChat to Slack. 35\% of them cited already using Slack in other collaborations or institutes as being one of the main reasons for wishing to switch. \\
Ease of use, pre-existing user-base, and freeing up collaboration members to focus on non-IT tasks are the main advantages to choosing to move to Slack.

In 2021 the communications team obtained a 2-month free-trial of Slack Business+ which was used to test the integration of SAML SSO with the LEGEND LDAP server successfully. 

\section{Proposal to the IB to use Confluence}
The communications team proposes to use Slack as the main team-chat app within the LEGEND collaboration, and to phase out RocketChat. 
Unlike with the recent proposal for the change in collaboration wiki, no transition plan is necessary to migrate from RocketChat to Slack as chat apps are not meant to archive content/material. The communication team plans to retire RocketChat but keep it accessible (read-only) for a few months. This exercise will be useful to monitor whether the collaboration is using chat apps correctly or not: if information is being kept solely on RocketChat then collaborators will access it frequently to look up information. Knowing this will allow the communications team to report back to the collaboration whether we need to rethink how we are using chat apps. 

A paid version of Slack is necessary to use SSO (Business+ plan) and enable chat history for the volume of users in the LEGEND collaboration. This amounts to \$6250/yr for 500 users. [TODO: how many actual users would we apply for, is annual billing ok?]

With the decision to use Slack, the collaboration commits to:
\begin{itemize}
    \item supporting the use of Slack with the intent of using it for the duration of the experiment.
    \item providing access for all collaborators, as well as access for anyone in the ``Full-Access Non-Collaborators'' LDAP group (engineers, undergraduate researchers,  administrational assistants, etc).
\end{itemize}


\end{document}
